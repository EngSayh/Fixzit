{
  "generatedAt": "2025-12-17T20:18:00Z",
  "source": "code-review:2025-12-17 (Phase 3 QA Gate + Comprehensive Analysis)",
  "context": "Phase 3 component creation completed; QA gate revealed build cache corruption, incomplete features, and mobile UX gaps",
  "issues": [
    {
      "key": "BUG-BUILD-CACHE-CORRUPTION",
      "externalId": "BUG-BUILD-001",
      "title": "Build fails with 200+ .nft.json ENOENT errors (cache corruption)",
      "category": "bug",
      "priority": "P0",
      "status": "open",
      "effort": "XS",
      "location": ".next/cache",
      "sourcePath": "code-review",
      "sourceRef": "code-review:build-validation:2025-12-17",
      "evidenceSnippet": "ENOENT .next/server/instrumentation.js.nft.json; EXIT CODE: 1",
      "description": "Next.js build fails due to missing .nft.json tracing files. Stale cache from incomplete builds. Code is valid (0 TS/ESLint errors, 1250+ tests passing). Fix: add prebuild cache cleanup script."
    },
    {
      "key": "BUG-LEAVEREQUESTS-INCOMPLETE",
      "externalId": "BUG-HR-001",
      "title": "LeaveRequestsList has 14 ESLint errors - incomplete feature implementation",
      "category": "bug",
      "priority": "P1",
      "status": "open",
      "effort": "M",
      "location": "components/hr/LeaveRequestsList.tsx",
      "sourcePath": "code-review",
      "sourceRef": "code-review:components/hr/LeaveRequestsList.tsx:1-527",
      "evidenceSnippet": "Unused: differenceInDays, Chip, TableToolbar, density, handleApprove",
      "description": "14 unused-vars violations indicate incomplete features: approve/reject workflow, density toggle, filter drawer rendering. Options: (A) complete features (4-6h), (B) remove dead code (1h), (C) suppress warnings (5m)."
    },
    {
      "key": "UX-MOBILE-CARDLIST-MISSING",
      "externalId": "UX-001",
      "title": "6 list components missing mobile CardList views (inconsistent UX)",
      "category": "ux",
      "priority": "P1",
      "status": "open",
      "effort": "L",
      "location": "components/fm/WorkOrdersViewNew.tsx, components/administration/UsersList.tsx, components/administration/RolesList.tsx, components/administration/AuditLogsList.tsx, components/hr/EmployeesList.tsx, components/finance/InvoicesList.tsx",
      "sourcePath": "code-review",
      "sourceRef": "code-review:mobile-ux-audit:2025-12-17",
      "evidenceSnippet": "Only PropertiesList/ProductsList have <CardList>; 6 lists table-only",
      "description": "Mobile users on 6 modules see desktop table instead of touch-optimized cards. Aqar/Souq have CardList; need to extend pattern to FM/HR/Finance/Admin. Effort: 2-3h per component (12-18h total)."
    },
    {
      "key": "EDGE-COMMANDPALETTE-CONFLICT",
      "externalId": "EDGE-001",
      "title": "Two CommandPalette implementations both use Cmd+K hotkey (potential conflict)",
      "category": "logic",
      "priority": "P3",
      "status": "open",
      "effort": "S",
      "location": "components/superadmin/CommandPalette.tsx, components/topbar/GlobalSearch.tsx",
      "sourcePath": "code-review",
      "sourceRef": "code-review:grep:cmdk|metaKey:2025-12-17",
      "evidenceSnippet": "Line 73: if (e.metaKey && e.key === 'k') (superadmin); Line 154: same (global)",
      "description": "If both superadmin CommandPalette and global GlobalSearch mount simultaneously, duplicate event listeners fire. Risk: edge case (may not occur in practice). Fix: add CommandPaletteContext to prevent duplicate registrations."
    },
    {
      "key": "OPS-CI-PIPELINE-MISSING",
      "externalId": "OPS-001",
      "title": "No CI/CD pipeline - regression risk on every merge",
      "category": "ops",
      "priority": "P1",
      "status": "open",
      "effort": "S",
      "location": ".github/workflows/qa.yml (NEW)",
      "sourcePath": "code-review",
      "sourceRef": "analysis:process-efficiency:2025-12-17",
      "evidenceSnippet": "Manual QA only; no automated PR checks",
      "description": "Create GitHub Actions workflow with lint/typecheck/test/build steps to prevent regressions. Effort: 1h. Impact: prevents 80% of avoidable regressions."
    },
    {
      "key": "FEATURE-SAVED-FILTERS",
      "externalId": "FEATURE-003",
      "title": "Saved filter presets (users can't save commonly-used filter combinations)",
      "category": "feature",
      "priority": "P2",
      "status": "open",
      "effort": "M",
      "location": "hooks/useTableQueryState.ts, components/tables/TableSavedViews.tsx",
      "sourcePath": "analysis",
      "sourceRef": "analysis:optional-enhancements:2025-12-17",
      "evidenceSnippet": "QuickChips exist but no persistence layer",
      "description": "Users manually recreate filters daily. Implement saved views with MongoDB persistence + user preferences. Effort: 6-8h. Impact: 50% time savings for heavy users."
    },
    {
      "key": "TEST-INTEGRATION-COVERAGE",
      "externalId": "TEST-002",
      "title": "List component integration tests missing (12 components untested end-to-end)",
      "category": "missing_test",
      "priority": "P2",
      "status": "open",
      "effort": "L",
      "location": "tests/integration/list-components.integration.test.ts",
      "sourcePath": "code-review",
      "sourceRef": "analysis:testing-recommendations:2025-12-17",
      "evidenceSnippet": "1250+ unit tests passing; 0 E2E list tests",
      "description": "Add Playwright tests for each list Ã— role (WorkOrders FM Manager, Users Admin, etc.). Verify: load, filter, pagination, mobile switch, no console errors. Effort: 8-12h."
    },
    {
      "key": "PERF-RECHARTS-SSR-AUDIT",
      "externalId": "PERF-004",
      "title": "30+ Recharts components need SSR safety audit (missing explicit heights)",
      "category": "performance",
      "priority": "P2",
      "status": "open",
      "effort": "S",
      "location": "components/superadmin/Sparkline.tsx, components/seller/analytics/*.tsx, components/ui/chart-*.tsx",
      "sourcePath": "code-review",
      "sourceRef": "code-review:grep:recharts:2025-12-17",
      "evidenceSnippet": "ResponsiveContainer found in 30+ files; most have height prop",
      "description": "Audit remaining Recharts instances to ensure all have explicit height prop (SSR-safe). Grep found 30+; likely 50-60 total. Effort: 2-3h."
    },
    {
      "key": "COMP-PLAYWRIGHT-STABILITY",
      "externalId": "COMP-002",
      "title": "Playwright tests need static anchors to avoid hydration errors (prefer <a href> over onClick)",
      "category": "tests",
      "priority": "P2",
      "status": "open",
      "effort": "M",
      "location": "components/marketplace/*.tsx (Playwright stubs)",
      "sourcePath": "instructions",
      "sourceRef": "instructions:.github/copilot-instructions.md:playwright-smoke",
      "evidenceSnippet": "Prefer static anchors (<a href=...>) in PLAYWRIGHT_TESTS mode",
      "description": "Marketplace Playwright stubs should render clickable product cards linking to /marketplace/product/demo-* with static anchors, not client event handlers, to prevent hydration errors and selector timeouts."
    }
  ]
}
