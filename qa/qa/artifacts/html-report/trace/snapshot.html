
<!DOCTYPE html>
<html lang="en">
  <body>
    <script>
      (async () => {
        if (!navigator.serviceWorker)
          throw new Error(`Service workers are not supported.\nMake sure to serve the Trace Viewer (${window.location}) via HTTPS or localhost.`);
        const hadController = Boolean(navigator.serviceWorker.controller);
        navigator.serviceWorker.register('sw.bundle.js');
        if (!hadController) {
          if (!navigator.serviceWorker.controller) {
            await new Promise(resolve => navigator.serviceWorker.addEventListener('controllerchange', resolve, { once: true }));
          }
          const traceUrl = new URL(location.href).searchParams.get('trace');
          if (traceUrl) {
            await fetch(`contexts?trace=${encodeURIComponent(traceUrl)}`).then(r => r.json());
          }
          location.reload();
        }
      })();
    </script>
    <script src="stall.js"></script>
  </body>
</html>
