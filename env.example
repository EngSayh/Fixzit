# =============================================================================
# FIXZIT ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env.local for development
# For production, configure these in your hosting platform (Vercel, AWS, etc.)
# =============================================================================

# === NODE ENVIRONMENT ===
NODE_ENV=development

# === APPLICATION URLS ===
NEXT_PUBLIC_APP_URL=http://localhost:3000
# NOTE: No separate backend on port 5000 - Next.js handles everything on port 3000

# Base URL for generating links (referrals, email templates, etc.)
# Production: https://fixzit.sa
# Staging: https://staging.fixzit.sa
# Development: http://localhost:3000
BASE_URL=http://localhost:3000
NEXT_PUBLIC_BASE_URL=http://localhost:3000

# =============================================================================
# CRITICAL: REQUIRED FOR PRODUCTION
# =============================================================================

# === DATABASE (MongoDB) ===
# Development (Docker): mongodb://admin:fixzit2024@localhost:27017/fixzit?authSource=admin
# Production: Use MongoDB Atlas connection string
MONGODB_URI=mongodb://localhost:27017/fixzit
MONGODB_DB=fixzit

# === JWT AUTHENTICATION ===
# MUST be 32+ characters, cryptographically random
# Generate: openssl rand -hex 32
# Production: Use AWS Secrets Manager, HashiCorp Vault, or environment variables
# NEVER commit the actual secret to git!
JWT_SECRET=

# === NEXTAUTH (OAuth Authentication) ===
# NextAuth secret for JWT signing (MUST be 32+ characters)
# Generate: openssl rand -base64 32
NEXTAUTH_SECRET=

# Internal API secret for server-to-server authentication
# This should be DIFFERENT from NEXTAUTH_SECRET (security best practice)
# Generate: openssl rand -base64 32
INTERNAL_API_SECRET=

# NextAuth URL (application base URL)
NEXTAUTH_URL=http://localhost:3000

# Google OAuth credentials (get from Google Cloud Console)
GOOGLE_CLIENT_ID=your_google_client_id_here.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_google_client_secret_here

# === SECURITY - EMAIL HASHING ===
# Salt for hashing email addresses in logs (privacy protection)
# This prevents rainbow table attacks on hashed email addresses
# Generate: openssl rand -hex 32
LOG_HASH_SALT=

# === OAUTH CONFIGURATION ===
# Comma-separated list of allowed email domains for OAuth sign-in
# Example: OAUTH_ALLOWED_DOMAINS="fixzit.com,fixzit.co,example.com"
# Default: fixzit.com,fixzit.co
OAUTH_ALLOWED_DOMAINS=fixzit.com,fixzit.co

# === SESSION MANAGEMENT ===
# Session duration in seconds
# Default: 86400 (24 hours)
# Options: 3600 (1 hour), 86400 (1 day), 604800 (7 days), 2592000 (30 days)
SESSION_DURATION=86400
SESSION_REMEMBER_DURATION=2592000

# =============================================================================
# PAYMENT GATEWAY (PayTabs - Saudi Arabia)
# =============================================================================
PAYTABS_PROFILE_ID=your_profile_id_here
PAYTABS_SERVER_KEY=your_server_key_here
PAYTABS_CLIENT_KEY=your_client_key_here
PAYTABS_REGION=SAU
PAYTABS_CURRENCY=SAR
PAYTABS_BASE_URL=https://secure.paytabs.sa

# =============================================================================
# MAPS & LOCATION (Google Maps)
# =============================================================================
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your_google_maps_api_key_here
GOOGLE_MAPS_API_KEY=your_server_side_google_maps_key

# =============================================================================
# ZATCA E-INVOICING (Saudi Arabia Compliance)
# =============================================================================
ZATCA_TAXPAYER_ID=300000000000003
ZATCA_API_URL=https://gw-fatoora.zatca.gov.sa/e-invoicing/core
ZATCA_CERTIFICATE_PATH=/path/to/zatca-cert.pem
ZATCA_PRIVATE_KEY_PATH=/path/to/zatca-private-key.pem
ZATCA_OTP=your_otp_from_zatca

# =============================================================================
# AWS SERVICES (S3, SES, CloudWatch)
# =============================================================================
AWS_ACCESS_KEY_ID=your_aws_access_key_id
AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key
AWS_REGION=me-south-1
AWS_S3_BUCKET=fixzit-uploads
AWS_SES_FROM_EMAIL=noreply@yourdomain.com

# =============================================================================
# EMAIL SERVICE (SendGrid OR AWS SES)
# =============================================================================
# Option 1: SendGrid (RECOMMENDED for Production)
SENDGRID_API_KEY=your_sendgrid_api_key
SENDGRID_FROM_EMAIL=noreply@yourdomain.com
SENDGRID_FROM_NAME=Fixzit
SENDGRID_REPLY_TO_EMAIL=support@yourdomain.com
SENDGRID_REPLY_TO_NAME=Fixzit Support

# SendGrid Advanced Features (Optional)
SENDGRID_UNSUBSCRIBE_GROUP_ID=your_unsubscribe_group_id
SENDGRID_IP_POOL_NAME=your_ip_pool_name
SENDGRID_WEBHOOK_VERIFICATION_KEY=your_webhook_key

# SendGrid Dynamic Templates (Optional - use Template IDs instead of HTML)
SENDGRID_TEMPLATE_WELCOME=d-your_welcome_template_id
SENDGRID_TEMPLATE_PASSWORD_RESET=d-your_password_reset_template_id
SENDGRID_TEMPLATE_NOTIFICATION=d-your_notification_template_id
SENDGRID_TEMPLATE_INVOICE=d-your_invoice_template_id

# Legacy Support (backward compatibility)
FROM_EMAIL=noreply@yourdomain.com

# Option 2: SMTP (Gmail, Office365, etc.)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your_email@yourdomain.com
EMAIL_PASS=your_app_specific_password
EMAIL_FROM=noreply@yourdomain.com

# =============================================================================
# SMS SERVICE (Twilio)
# =============================================================================
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+966xxxxxxxxx
TWILIO_VERIFY_SERVICE_SID=your_verify_service_sid

# =============================================================================
# AI & EMBEDDINGS (OpenAI)
# =============================================================================
# Optional: Enables higher quality answers in Help Q&A and Copilot
OPENAI_API_KEY=your_openai_api_key

# =============================================================================
# MONITORING & LOGGING (Optional but Recommended for Production)
# =============================================================================
# Sentry (Error Tracking)
SENTRY_DSN=your_sentry_dsn
SENTRY_ORG=your_org
SENTRY_PROJECT=your_project

# Datadog (APM & Monitoring)
DATADOG_API_KEY=your_datadog_api_key
DATADOG_APP_KEY=your_datadog_app_key
DATADOG_SITE=datadoghq.com

# =============================================================================
# CACHING (Redis - Optional for Distributed Rate Limiting)
# =============================================================================
REDIS_URL=redis://username:password@host:port
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# =============================================================================
# MODULE CONTROL (Dynamic Import System)
# =============================================================================
# Set to 'false' or remove to disable specific modules
# Disabled modules return HTTP 501 with clear error messages
WO_ENABLED=true              # Work Orders module
INVOICE_ENABLED=true         # Invoicing module  
PROPERTY_ENABLED=true        # Property Management (Aqar) module
ASSET_ENABLED=true           # Asset Tracking module
VENDOR_ENABLED=true          # Vendor Management module
RFQ_ENABLED=true             # Request for Quote module
SUPPORT_ENABLED=true         # Support Tickets module
MARKETPLACE_ENABLED=true     # Marketplace module
ATS_ENABLED=true             # Applicant Tracking System module

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_PAYMENT_GATEWAY=true
ENABLE_SMS_OTP=false
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_GOOGLE_MAPS=true
ENABLE_ZATCA_INTEGRATION=true
ENABLE_AQAR_MODULE=true
ENABLE_ATS_MODULE=true

# =============================================================================
# RATE LIMITING
# =============================================================================
# Override default rate limits (requests per window)
KB_SEARCH_MAX_RATE_PER_MIN=60

# =============================================================================
# FILE STORAGE
# =============================================================================
STORAGE_TYPE=local           # Options: local, s3
MAX_FILE_SIZE=10485760       # 10MB in bytes

# =============================================================================
# SESSION & SECURITY
# =============================================================================
SESSION_SECRET=your_session_secret_here
COOKIE_DOMAIN=.yourdomain.com
COOKIE_SECURE=true           # Set to true in production (requires HTTPS)

# =============================================================================
# BUILD & PERFORMANCE
# =============================================================================
NODE_OPTIONS=--max-old-space-size=4096  # Required for production build

# =============================================================================
# DEVELOPMENT TOOLS
# =============================================================================
# Enable detailed logging in development
DEBUG=false
LOG_LEVEL=info               # Options: error, warn, info, verbose, debug

# =============================================================================
# NOTES
# =============================================================================
# 1. Copy this file to .env.local for development
# 2. Never commit .env.local to git (already in .gitignore)
# 3. For production, set these in your hosting platform environment variables
# 4. Generate strong secrets: openssl rand -hex 32
# 5. See PRODUCTION_DEPLOYMENT_GUIDE.md for detailed setup instructions
